<script>
    $(document).ready(function () {

        function findLatLon() {
            // We define our address
            $address = '{{ wedding.address~', '~wedding.city~', '~wedding.country }}';
            $.ajax({
                url:"http://maps.googleapis.com/maps/api/geocode/json?address="+$address+"&sensor=false",
                type: "POST",
                async: false,
                success:function(res){
                    $('#map').attr('lat',res.results[0].geometry.location.lat);
                    $('#map').attr('lng',res.results[0].geometry.location.lng);
                }
            });
        }
        function initialize() {
            // Create an array of styles.
            addr = '<p><b>{{ wedding.address }}</b></p>' +
                    '<p>{{ wedding.city }}</p>' +
                    '<p>{{ wedding.country }}</p>';
            findLatLon();

            lat = $('#map').attr('lat');
            lng = $('#map').attr('lng');
            var styles = [
                {
                    stylers: [
                        {hue: "#D44645"},
                        {saturation: 0}
                    ]
                },
                {
                    featureType: 'water',
                    stylers: [
                        {visibility: "on"},
                        {color: "#9a9efd"},
                        {weight: 2.2},
                        {gamma: 2.54}
                    ]
                },
                {
                    featureType: "road",
                    elementType: "geometry",
                    stylers: [
                        {lightness: 100},
                        {visibility: "simplified"}
                    ]
                }, {
                    featureType: "road",
                    elementType: "labels",
                    stylers: [
                        {hue: "#00ffee"},
                        {lightness: 10},
                        {visibility: "simplified"}
                    ]
                }
            ];

            // Create a new StyledMapType object, passing it the array of styles,
            // as well as the name to be displayed on the map type control.
            var styledMap = new google.maps.StyledMapType(styles,
                    {name: "Styled Map"});

            var mapCanvas = document.getElementById('map');
            var location = new google.maps.LatLng(lat, lng);
            var mapOptions = {
                zoom: 15,
                center: location,
                mapTypeControlOptions: {
                    mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']
                },
                scrollwheel: false,
                disableDefaultUI: true
            };
            var map = new google.maps.Map(mapCanvas, mapOptions);

            //Associate the styled map with the MapTypeId and set it to display.
            map.mapTypes.set('map_style', styledMap);
            map.setMapTypeId('map_style');

            // To add the marker to the map, use the 'map' property
            var image = 'images/icon/map_icon.png';

            var infowindow = new google.maps.InfoWindow({
                content: addr
            });

            var marker = new google.maps.Marker({
                position: location,
                map: map,
                icon: image
            });
            marker.addListener('click', function() {
                infowindow.open(map, marker);
            })
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    })
</script>